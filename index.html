<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, viewport-fit=cover" name="viewport" />
  <title>PageBud</title>

  <!-- Apply theme ASAP -->
  <script src="theme-init.js"></script>

  <!-- Styles -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <link href="style.css?v=cards2" rel="stylesheet" />
  <script defer src="rating-controls.js"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script src="firebase-init.js"></script>
</head>

<body>
  <div class="app-container">
    <header class="header">
      <!-- Title + greeting stacked -->
      <div class="title-stack">
        <h1 class="page-title">PageBud</h1>
        <div id="homeGreeting" class="page-subtle"></div>
      </div>
      <!-- No Discover button here -->
      <div class="header-actions"></div>
    </header>

    <!-- Filter chips -->
    <div class="categories scroll-x" id="filter-chips">
      <div class="category active" data-filter="all">All Books</div>
      <div class="category" data-filter="favorites">Favorites</div>
      <div class="category" data-filter="reading">Reading</div>
      <div class="category" data-filter="finished">Finished</div>
      <div class="category" data-filter="want">TBR</div>
      <div class="category" data-filter="dnf">DNF</div>
      <div class="category" data-filter="owned">Books I Own</div>
      <div class="category" data-filter="wishlist">Wishlist</div>
    </div>

    <!-- Search + view toggle -->
    <div class="row pad">
      <input class="input" id="searchInput" placeholder="Search by title or author..." type="search" />
      <div class="chip-group" id="viewToggle">
        <button class="chip active" data-view="grid">Grid</button>
        <button class="chip" data-view="list">List</button>
      </div>
    </div>

    <!-- Discover + Friends preview cards (to kort side-om-side) -->
    <section class="grid-2 pad">
      <a class="card card-link" href="discover.html">
        <div class="card-head">
          <h2>Discover</h2>
        </div>
        <div class="muted">Trending &amp; recommendations</div>
      </a>

      <a class="card card-link" href="feed.html">
        <div class="card-head">
          <h2>Friends</h2>
        </div>
        <div class="muted">See what friends read</div>
      </a>
    </section>


    <!-- My Library -->
    <section class="pad">
      <div class="card">
        <div class="card-head">
          <h2>My Library</h2>
        </div>
        <div class="books-grid" id="books-grid"></div>
        <div class="muted small" id="empty-library" style="display:none;padding:12px">
          Your library is empty. Tap + to add a book.
        </div>
      </div>
    </section>

    <!-- Friends activity -->
    <section class="pad" id="friends-activity">
      <div class="card">
        <div class="card-head">
          <h2>Friends activity</h2>
        </div>
        <div class="feed-list" id="friends-feed" style="padding:12px"></div>
      </div>
    </section>

    <!-- Add Book FAB -->
    <button aria-label="Add Book" class="add-book" id="add-book-btn" onclick="location.href='add-book.html'"
      title="Add Book" type="button"><i class="fas fa-plus"></i></button>
  </div>

  <script>
    // Ensure layout reserves space for the FAB
    (function () { if (document.getElementById('add-book-btn')) document.body.classList.add('has-add-fab'); }());
    // Kick off friends feed if auth ok (existing helper)
    requireAuth?.(() => window.startSocialFeed && window.startSocialFeed());
  </script>

  <!-- App scripts -->
  <script src="reset-utils.js"></script>
  <script defer src="nav.js"></script>
  <script src="profiles.js"></script>
  <script src="activity.js"></script>
  <script src="social-feed.js"></script>
  <script src="script.js"></script>
  <script src="toast.js" defer></script>
  <script defer src="timer.js"></script>
  <script src="sync.js" defer></script>
  <script src="social-feed-preview.js" defer></script>

  <!-- IMPORTANT: i18n before index-actions -->
  <script src="i18n.js?v=1"></script>
  <script src="header-actions.js" defer></script>
  <script src="index-actions.js?v=greet3"></script>
  <script src="goal-badge.js" defer></script>
  <script src="library-enricher.js" defer></script>
</body>

</html>